% This is a modified version of the tufte-latex book example in which the title page and the contents page resemble Tufte's VDQI book, using Kevin Godby's code from this thread at https://groups.google.com/forum/#!topic/tufte-latex/ujdzrktC1BQ.

%% Unfortunately for the contents to contain
%% the "Parts" lines successfully, hyperref
%% needs to be disabled.
\documentclass[nohyper,nobib,a4,12pt]{tufte-book} %nobib

\usepackage{nameref}
%BIBLIOGRAPHY
% \usepackage{hyphenat}
\usepackage{url}
\usepackage[backend=biber,doi=false,isbn=false,url=false,eprint=false,style=verbose,citestyle=authoryear-comp,maxbibnames=999,firstinits=true,maxcitenames=1]{biblatex}
\addbibresource{../ZoteroLibUpdated/ZoteroLibUpdated.bib}
%\addbibresource{references.bib}
\usepackage{xargs}

%first init comes from: https://tex.stackexchange.com/questions/490049/towards-a-concise-fullcite-command, It's a good ressource

% Remove the In: if there is no journal title. But if not in my defined shortcite, it means that the publication type is ill-defined (should be online, or something without journal)
% Thanks to https://tex.stackexchange.com/questions/502657/how-to-remove-in-from-bibliography-if-there-is-no-journal-information
\renewbibmacro*{in:}{%
  \iffieldundef{journaltitle}
    {}
    {\printtext{\bibstring{in}\intitlepunct}}}

% a fullcite command described by removing stuff
\DeclareCiteCommand{\fullcite}
  {\usebibmacro{prenote}}
  {\clearfield{month}\clearfield{day}\clearfield{pages}\clearfield{volume}\clearfield{number}\clearfield{issue}\clearfield{urlyear}\clearfield{urlmonth}\clearfield{pagetotal}%\clearfield{title}\clearfield{journaltitle}%
   \usedriver
     {\DeclareNameAlias{sortname}{default}}
     {\thefield{entrytype}}}
  {\multicitedelim}
  {\usebibmacro{postnote}}
  
  % a fullcite command described by adding stuff
  % Thanks https://tex.stackexchange.com/questions/490049/towards-a-concise-fullcite-command (also:https://tex.stackexchange.com/questions/479590/change-journaltitle-to-italics-in-fullcite, https://tex.stackexchange.com/questions/339681/abbreviate-journal-title-in-fullcite-command)
  \DeclareCiteCommand{\myfullcite}
  {\usebibmacro{prenote}}
  {%
     \printnames[given-family]{labelname}%
     \setunit{\addcomma\space}%
  %
     \printfield{journaltitle}%
     \setunit{\addspace}%
     \printtext[parens]{%
       \printdate}}
  {\multicitedelim}
  {\usebibmacro{postnote}}
  
  % from me: Remove the visited on https://tex.stackexchange.com/questions/400384/how-to-disable-biblatex-showing-visited-on-on-the-references
%\AtEveryBibitem{
  %  \clearfield{urlyear}
    %\clearfield{urlmonth}
%}
% Only year
%\AtEveryBibitem{\clearfield{month}}
%\AtEveryBibitem{}
%\AtEveryCitekey{\clearfield{month}\clearfield{day}\clearfield{pages}\clearfield{volume}\clearfield{number}\clearfield{issue}\clearfield{urlyear}\clearfield{urlmonth}\clearfield{pagetotal}\clearfield{publication}} % Remove day only in fullcite


\renewcommandx{\cite}[3][1={0pt},2={}]{\sidenote[][#1]{\fullcite[#2]{#3}.}}
% from me: short citation in sideline: https://tex.stackexchange.com/questions/414716/options-for-styling-fullcite
% No space: https://tex.stackexchange.com/questions/25891/fullcite-without-indent-in-biblatex ---> Ã¥DELETED
%% From me: 
\usepackage{ebgaramond}
%Tittle in Smal cap, to change
\usepackage{titlesec}
% Display instead of hang makes it on two line: Chapter 1\\blabla
\makeatletter
\titleformat{\chapter}[display]{\huge\scshape}{\@chapapp~\thechapter}{.5\baselineskip}{}%[\vspace{2ex}\titlerule]
\titleformat{\section}{\Large\scshape}{\thesection}{1em}{}
\titleformat{\subsection}{\large\scshape}{\thesubsection}{1em}{}
\titleformat{\paragraph}[runin]{\scshape}{\theparagraph}{}{}
\makeatother

%%
% Book metadata
\title{Computational infectious disease dynamics modeling towards informed control decisions}
\date{\today}
\author[Joseph Lemaitre]{Joseph \ Lemaitre}
\publisher{Under the supervision of Prof. Andrea Rinaldo and Dr. Damiano Pasetto.}

%%
% For nicely typeset tabular material
\usepackage{booktabs}

%%
% For graphics / images
\usepackage{graphicx}
\setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}

% The fancyvrb package lets us customize the formatting of verbatim
% environments.  We use a slightly smaller font.
\usepackage{fancyvrb}
\fvset{fontsize=\normalsize}

%%
% Prints argument within hanging parentheses (i.e., parentheses that take
% up no horizontal space).  Useful in tabular environments.
\newcommand{\hangp}[1]{\makebox[0pt][r]{(}#1\makebox[0pt][l]{)}}

%%
% Prints an asterisk that takes up no horizontal space.
% Useful in tabular environments.
\newcommand{\hangstar}{\makebox[0pt][l]{*}}

%%
% Prints a trailing space in a smart way.
\usepackage{xspace}

% Prints the month name (e.g., January) and the year (e.g., 2008)
\newcommand{\monthyear}{%
  \ifcase\month\or January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or
  December\fi\space\number\year
}

% Prints an epigraph and speaker in sans serif, all-caps type.
\newcommand{\openepigraph}[2]{%
  %\sffamily\fontsize{14}{16}\selectfont
  \begin{fullwidth}
  \sffamily\large
  \begin{doublespace}
  \noindent\allcaps{#1}\\% epigraph
  \noindent\allcaps{#2}% author
  \end{doublespace}
  \end{fullwidth}
}

% Inserts a blank page
\newcommand{\blankpage}{\newpage\hbox{}\thispagestyle{empty}\newpage}

\usepackage{units}

% Typesets the font size, leading, and measure in the form of 10/12x26 pc.
\newcommand{\measure}[3]{#1/#2$\times$\unit[#3]{pc}}

% Macros for typesetting the documentation
\newcommand{\hlred}[1]{\textcolor{Maroon}{#1}}% prints in red
\newcommand{\hangleft}[1]{\makebox[0pt][r]{#1}}
\newcommand{\hairsp}{\hspace{1pt}}% hair space
\newcommand{\hquad}{\hskip0.5em\relax}% half quad space
\newcommand{\TODO}{\textcolor{red}{\bf TODO!}\xspace}
\newcommand{\ie}{\textit{i.\hairsp{}e.}\xspace}
\newcommand{\eg}{\textit{e.\hairsp{}g.}\xspace}
\newcommand{\na}{\quad--}% used in tables for N/A cells
% + removed some stuff
% Generates the index
%\usepackage{makeidx}
%\makeindex

%%%% Kevin Godny's code for title page and contents from https://groups.google.com/forum/#!topic/tufte-latex/ujdzrktC1BQ
%\makeatletter
%\renewcommand{\maketitlepage}{%
%\begingroup%
%\setlength{\parindent}{0pt}
%
%{\fontsize{24}{24}\selectfont\textit{\@author}\par}
%
%\vspace{1.75in}{\fontsize{36}{54}\selectfont\@title\par}
%
%\vspace{0.5in}{\fontsize{14}{14}\selectfont\textsf{\smallcaps{\@date}}\par}
%
%\vfill{\fontsize{14}{14}\selectfont\textit{\@publisher}\par}
%
%\thispagestyle{empty}
%\endgroup
%}
%\makeatother
%\titlecontents{part}%
%    [0pt]% distance from left margin
%    {\addvspace{0.25\baselineskip}}% above (global formatting of entry)
%    {\allcaps{Part~\thecontentslabel}\allcaps}% before w/ label (label = ``Part I'')
%    {\allcaps{Part~\thecontentslabel}\allcaps}% before w/o label
%    {}% filler and page (leaders and page num)
%    [\vspace*{0.5\baselineskip}]% after
%  \makeatletter
%\titleformat{\part}[display]
%  {\Huge\scshape\filright}
%  {\partname~\thepart}
%  {20pt}
%  {}
%\makeatother
%\titlecontents{chapter}%
%    [4em]% distance from left margin
%    {}% above (global formatting of entry)
%    {\contentslabel{2em}\textit}% before w/ label (label = ``Chapter 1'')
%    {\hspace{0em}\textit}% before w/o label
%    {\qquad\thecontentspage}% filler and page (leaders and page num)
%    [\vspace*{0.5\baselineskip}]% after
%%%% End additional code by Kevin Godby



%%% Needed for compilation.
%\renewcommand\allcapsspacing[1]{{\addfontfeature{LetterSpace=15}#1}}
%\renewcommand\smallcapsspacing[1]{{\addfontfeature{LetterSpace=10}#1}}
%%% Joseph's thesis
% cholera-rainfall
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{makecell}
\usepackage{amsmath}
\usepackage{bm}
%Intro
\newcommand{\eqname}[1]{\tag*{#1}} %tag equations by name
% 
\usepackage{tabularx}
\usepackage[most]{tcolorbox}
\newtcolorbox{mybox}[1]{
    tikznode boxed title,
    enhanced,
    breakable, 
    arc=0mm,
    interior style={white},
    attach boxed title to top center= {yshift=-\tcboxedtitleheight/2},
    fonttitle=\bfseries,
    colbacktitle=white,coltitle=black,
    boxed title style={size=normal,colframe=white,boxrule=0pt},
    title={#1}}
    
%\AtEveryCitekey{\clearfield{url}\clearfield{doi}\clearfield{isbn}\clearfield{issn}}

%% Define \longfullcite to include all authors (https://tex.stackexchange.com/questions/142148/typeset-one-citation-with-all-authors)
\makeatletter
\DeclareCiteCommand{\longfullcite}
  {\usebibmacro{prenote}}
  {\usedriver
     {\c@maxnames\blx@maxbibnames\relax
      \DeclareNameAlias{sortname}{default}}
     {\thefield{entrytype}}}
  {\multicitedelim}
  {\usebibmacro{postnote}}
\makeatother
% section in table of content
\setcounter{tocdepth}{3}

%Hyperref likes to be loaded last
\usepackage{hyperref}
%No link in TOC, that breaks tuftebook
\makeatletter
\let\Hy@linktoc\Hy@linktoc@none
\makeatother
\usepackage[open,openlevel=2]{bookmark} %open up to level 2 by default

% Numbered chapters 
\setcounter{secnumdepth}{0}

%longer page
\usepackage{geometry}
 \geometry{
 a4paper,
textheight=690pt,
 }
\begin{document}

%\begin{fullwidth}
	
% Front matter
%\frontmatter

% r.1 blank page
% \blankpage

% v.2 epigraphs
% \newpage\thispagestyle{empty}
% \openepigraph{%
% The public is more familiar with bad design than good design.
% It is, in effect, conditioned to prefer bad design, 
% because that is what it lives with. 
% The new becomes threatening, the old reassuring.
% }{Paul Rand%, {\itshape Design, Form, and Chaos}
% }
% \vfill
% \openepigraph{%
% A designer knows that he has achieved perfection 
% not when there is nothing left to add, 
% but when there is nothing left to take away.
% }{Antoine de Saint-Exup\'{e}ry}
% \vfill
% \openepigraph{%
% \ldots the designer of a new system must not only be the implementor and the first 
% large-scale user; the designer should also write the first user manual\ldots 
% If I had not participated fully in all these activities, 
% literally hundreds of improvements would never have been made, 
% because I would never have thought of them or perceived 
% why they were important.
% }{Donald E. Knuth}


% r.3 full title page
%\maketitle

% r.5 contents
%\pdfbookmark[section]{\contentsname}{toc}
%\tableofcontents

%\listoffigures

%\listoftables

% r.7 dedication
%\cleardoublepage
%~\vfill
%\begin{doublespace}
%\noindent\fontsize{18}{22}\selectfont\itshape
%\nohyphenation
%Dedicated to those who appreciate \LaTeX{} 
%and the work of \mbox{Edward R.~Tufte} 
%and \mbox{Donald E.~Knuth}.
%\end{doublespace}
%\vfill
%\vfill

%\end{fullwidth}
% r.9 introduction
%\cleardoublepage
%\input{introduction}

%%
% Start the main matter (normal chapters)
%\mainmatter
%\part{Cholera modeling}
\input{cholera}
\input{cholera-rainfall}
\input{cholera-haiti-ocv}

%\part{Scientific and Public-Health response to the COVID-19 pandemic}
  
\input{covid-pipeline-reports}
\input{covid-switzerland-npi}
\input{covid-italy-ocp}

%\input{conclusions}


%%
% The back matter contains appendices, bibliographies, indices, glossaries, etc.
%\backmatter
\begin{fullwidth}
%\printbibliography
\end{fullwidth}

\end{document}